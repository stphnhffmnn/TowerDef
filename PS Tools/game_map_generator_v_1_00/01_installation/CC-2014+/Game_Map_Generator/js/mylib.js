try{var gCSInterface;var gResourceBundle;var gPanelPath;var gTotalImages=54;var gExtensionId="GameMapGenerator.extension";var gShowErrors=true;var gExternalFolder="";var gPersistentOn=true;var ddAddMoreTextures;var divImages;var isocons;var gDefaultText="";$(document)["ready"](function(){try{gCSInterface=  new CSInterface();gResourceBundle= gCSInterface["initResourceBundle"]();GetUIItems();gPanelPath= gCSInterface["getSystemPath"](SystemPath.EXTENSION);gDefaultText= gResourceBundle["keySelecttextures"];isocons["innerHTML"]= gResourceBundle["keySelecttextures"];ResetIcons();EvalScript("myLib.retrievePreferences();",RetrievePreferences);Persistent(gPersistentOn)}catch(e){if(gShowErrors){alert("ready : resource bundle error "+ e)};gCSInterface= null;gResourceBundle= {}}});function EvalScript(script,callback){loadJSX();gCSInterface["evalScript"](script,callback)}function loadJSX(){var csInterface= new CSInterface();var fileName="mylib.jsx";var extensionRoot=csInterface["getSystemPath"](SystemPath.EXTENSION)+ "/host/";csInterface["evalScript"]("$.evalFile(\""+ extensionRoot+ fileName+ "\")")}function GetUIItems(){divImages= document["getElementById"]("container");isocons= document["getElementById"]("isocons")}function RemoveAllFromDiv(){try{var imageNumber=0;var olddiv=document["getElementById"]("img"+ imageNumber);while(olddiv){divImages["removeChild"](olddiv);imageNumber++;olddiv= document["getElementById"]("img"+ imageNumber)}}catch(e){if(gShowErrors){alert("RemoveAllFromDiv : "+ e)}}}function FolderPick(){try{var result=window["cep"]["fs"]["showOpenDialog"](false,true);if(result["err"]=== cep["fs"]["NO_ERROR"]&& result["data"]!== undefined&& result["data"]["length"]> 0){AddAllImages(result["data"]);gExternalFolder= result["data"];gDefaultText= isocons["innerHTML"]}}catch(e){if(gShowErrors){alert("FolderPick catch : "+ e)}}}function ResetIcons(){try{AddAllImages(gPanelPath+ "/lib/iconLib");gExternalFolder= "";isocons["innerHTML"]= "SELECT AN ICON"}catch(e){if(gShowErrors){alert("ResetTextures catch : "+ e)}}}function RetrievePreferences(inPreferencesAsSource){try{var params=eval(inPreferencesAsSource);if(params!== undefined){gExternalFolder= params["currentFolder"];if(gExternalFolder!= (gPanelPath+ "/lib/iconLib")){AddAllImages(gExternalFolder);gDefaultText= isocons["innerHTML"]}}}catch(e){if(gShowErrors){alert("RetrievePreferences : "+ e+ " : "+ inPreferencesAsSource)}}}function Persistent(inOn){var csEvent;if(inOn){csEvent=  new CSEvent("com.adobe.PhotoshopPersistent","APPLICATION")}else {csEvent=  new CSEvent("com.adobe.PhotoshopUnPersistent","APPLICATION")};csEvent["extensionId"]= gExtensionId;gCSInterface["dispatchEvent"](csEvent)}function TextureClickImg(inThis){TextureClick(inThis,false)}function TextureClick(inUIElement){try{var JSONText=ParamsToParams(inUIElement["getAttribute"]("data-fullres"));EvalScript("myLib.runProcess('"+ JSONText+ "');");scaleit()}catch(errObject){if(gShowErrors){alert("TextureClick : "+ errObject)}}}function scaleit(){var csInterface= new CSInterface();loadJSX();var value=jQuery(".ui--slider")["slider"]("value");csInterface["evalScript"]("scale_obj(\""+ value+ "\")")}function ParamsToParams(inID,inOn){var s;var o={};o["filesArray"]= [];o["filesArray"]["push"](inID);o["stateArray"]= [];o["stateArray"]["push"](inOn);o["showHelpMessage"]= false;o["version"]= "1";if(gExternalFolder["length"]){o["currentFolder"]= gExternalFolder}else {o["currentFolder"]= gPanelPath+ "/lib/iconLib"};s= JSON["stringify"](o);return s}function AddAllImages(inFolder){try{var csInterface= new CSInterface();loadJSX();csInterface["evalScript"]("myLib.createImages('"+ escape(encodeURIComponent(inFolder))+ "');",AddAllImagesCallback)}catch(e){alert("AllAllImages error: "+ e)}}function MouseOverImg(inUIElement){try{isocons["innerHTML"]= inUIElement["getAttribute"]("data-fullres")}catch(e){alert(e)}}function MouseOutImg(inUIElement){try{isocons["innerHTML"]= "SELECT AN ICON"}catch(e){alert(e)}}function AddAllImagesCallback(inObjectAsString){try{var params=eval(inObjectAsString);var ClickFunction=function(){TextureClickImg(this,false)};var MouseFunction=function(){MouseOverImg(this)};var MouseOutFunction=function(){MouseOutImg(this)};var imageNumber=0;var delimiter=IsWindowsOS()?"\\":"/";if(params!== undefined){for(var i=0;i< params["files"]["length"];i++){if(params["files"][i]["toLowerCase"]()["lastIndexOf"](".png")=== (params["files"][i]["length"]- 4)|| params["files"][i]["toLowerCase"]()["lastIndexOf"](".png")=== (params["files"][i]["length"]- 4)){var newimg=document["createElement"]("span");newimg["setAttribute"]("id","img"+ imageNumber.toString());var fileNameStart=params["files"][i]["lastIndexOf"](delimiter)+ 1;var fileNameEnd=params["files"][i]["length"]- 4;var fileName=params["files"][i]["substr"](fileNameStart,fileNameEnd- fileNameStart);newimg["setAttribute"]("data-fullres",fileName);var urlFileName="url('"+ params["files"][i]+ "')";newimg["style"]["backgroundImage"]= urlFileName;newimg["onclick"]= ClickFunction;newimg["onmouseover"]= MouseFunction;newimg["onmouseout"]= MouseOutFunction;if(imageNumber=== 0){RemoveAllFromDiv()};divImages["appendChild"](newimg);imageNumber++}}};gTotalImages= imageNumber}catch(e){alert("AddAllImagesCallback error: "+ e)}}function IsWindowsOS(){var isWindows=true;if(navigator["userAgent"]["indexOf"]("Mac OS X")!=  -1){isWindows= false};return isWindows}}catch(e){if(gShowErrors){alert("Probably a syntax error: "+ e)}};function urlopen(){cep["util"]["openURLInDefaultBrowser"]("http://www.3d-map-generator.com")}